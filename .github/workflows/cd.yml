name: ğŸšš Continuous Delivery

on:
  workflow_dispatch:
  workflow_run:
    workflows: [ "ğŸ” Continuous Integration" ]
    branches: [ main ]
    types:
      - completed
env:
  TF_WORKSPACE: keinsell-dev
  CONFIGU_ORG: ${{ secrets.CONFIGU_ORG }}
  CONFIGU_SECRET: ${{ secrets.CONFIGU_SECRET }}

jobs:
  release:
    runs-on: methylphenidate-runner-set
    steps:
      - name: ğŸ“œ Checkout Repository
        uses: actions/checkout@v3
        with:
          fetch-depth: 0
      # Bump Versions
      # Generate Changelog
      # Publish Docker Image
      # Publish Artifacts on Github Releases
  deploy:
    runs-on: methylphenidate-runner-set
    concurrency:
      group: "deploy"
      cancel-in-progress: false
    steps:
      - name: ğŸ“œ Checkout Repository
        uses: actions/checkout@v3
        with:
          fetch-depth: 0
      # Push infrastructure
      # Deploy application
      # Migrate database
  rollback:
    runs-on: methylphenidate-runner-set
    steps:
      - name: ğŸ“œ Checkout Repository
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

  monitor:
    runs-on: methylphenidate-runner-set
    steps:
      - name: ğŸ“œ Checkout Repository
        uses: actions/checkout@v3
        with:
          fetch-depth: 0